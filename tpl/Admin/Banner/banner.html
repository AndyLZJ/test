<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>二期——内容管理bannner管理</title>
		<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	    <link rel="stylesheet" href="__PUBLIC__/Dist/css/comm.css">
        <link rel="stylesheet" href="__PUBLIC__/Css/bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="__PUBLIC__/Dist/font-awesome-4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="__PUBLIC__/Dist/ionicons-2.0.1/css/ionicons.min.css">
        <link rel="stylesheet" href="__PUBLIC__/plugins/jvectormap/jquery-jvectormap-1.2.2.css">
        <link rel="stylesheet"href="__PUBLIC__/Css/skins/comm.css">
        <link rel="stylesheet" href="__PUBLIC__/Dist/css/AdminLTE.min.css">
        <link rel="stylesheet" href="__PUBLIC__/Dist/css/skins/_all-skins.min.css">
        <link rel="stylesheet"href="__PUBLIC__/plugins/layer/skin/layer.css">
        <link rel="stylesheet"href="__PUBLIC__/plugins/iCheck/all.css">
		<!-- daterange picker -->
		<link rel="stylesheet" href="__PUBLIC__/plugins/daterangepicker/daterangepicker.css">
		<!-- bootstrap datepicker -->
		<link rel="stylesheet" href="__PUBLIC__/plugins/datepicker/datepicker3.css">
		<!-- iCheck for checkboxes and radio inputs -->
		<!-- Bootstrap Color Picker -->
		<link rel="stylesheet" href="__PUBLIC__/plugins/colorpicker/bootstrap-colorpicker.min.css">
		<!-- Bootstrap time Picker -->
		<link rel="stylesheet" href="__PUBLIC__/plugins/timepicker/bootstrap-timepicker.min.css">
		<!-- Select2 -->
		<link rel="stylesheet" href="__PUBLIC__/plugins/select2/select2.min.css">
		<style>
			
		</style>
	</head>
    
	<body>
		<!--内容区域顶栏面包屑开始-->
		<section class="content-header">
			<h1 class="info_title">
                            内容管理
        <small>/Banner管理</small>
      </h1>
			<ol class="breadcrumb">
				<li>
					
				</li>
			</ol>
		</section>
		<!--内容区域顶栏面包屑结束-->
		<section class="content">
			<div class="box">
				<div class="box-body">
					<div id="example1_wrapper" class="dataTables_wrapper form-inline dt-bootstrap ">

						<div class="box-header with-border">
							<h3 class="box-title ">Banner管理</h3>
						</div>
						<form class="form-horizontal">
							<div class="box-body">

								<div class="form-group" id="supplier">
									<label for="inputEmail3" class="col-sm-2 control-label"><span class="color_red">*</span>当前Banner：</label>
									<div class="col-sm-10">
										<div class="box box-success " style="width: 660px;height: 310px;">
											<div class="box-body">
												<img style="width: 640px;height: 290px;" src="{$banner_img}"  onerror="this.src='/Public/Images/photo1.png'"  width="100%" />
											</div>
										</div>
									</div>
								</div>

								<div class="form-group">
									<label for="inputEmail3" class="col-sm-2 control-label"> <span class="color_red">*</span>Banner上传：</label>
									<div class="col-sm-10">
										<input type="hidden" name="banner_covers" value="{$data.welfare_covers}" id="filename"/>
							           <input type="file" class="btn btn-primary" id="file" name="file"><i class="fa fa-folder-open"></i></input><span class="ml15"> (支持：gif、jpg、jpeg、png格式　尺寸：640px*290px)</span>
									</div>
								</div>
							</div>
							<div class="box-footer">
								<div class="form-group">
									<label class="col-sm-2 control-label"></label>
									<div class="col-sm-10">
										<div class="col-sm-6">
											<!--<a onclick="bannerYL();" class="btn btn-info form-group_but">预览</a>-->
										</div>
									</div>
								</div>
							</div>
						</form>
						<!--内容結束-->
					</div>
				</div>
			</div>
		</section>

		<!--上传头像弹窗-->
		<div id="bannerYL" style="display: none; ">
			<div class="box-body ">
				<div style="width: 380px; margin: auto;">
					<img style="width: 100%;" src="__PUBLIC__/Dist/img/bannerpopup.png" />
				</div>
				<div>
					<img id="image" style="position: fixed;width: 380px;height: 175px; top: 127px;" src="" />
				</div>
				<div class="col-sm-12 text-center mt10">
					<a id="bta" class="btn btn-info form-group_but mr15">保存</a>
					<a id="btb" class="btn btn-default form-group_but">取消</a>
				</div>
			</div>
		</div>
		<!--上传头像区域结束-->
		<script src="__PUBLIC__/plugins/jQuery/jquery-2.2.3.min.js"></script>
        <script src="__PUBLIC__/Js/js/bootstrap.min.js"></script>
        <script src="__PUBLIC__/plugins/fastclick/fastclick.js"></script>
        <script src="__PUBLIC__/Dist/js/app.min.js"></script>
        <script src="__PUBLIC__/plugins/sparkline/jquery.sparkline.min.js"></script>
        <script src="__PUBLIC__/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
        <script src="__PUBLIC__/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
        <script src="__PUBLIC__/plugins/slimScroll/jquery.slimscroll.min.js"></script>
        <script src="__PUBLIC__/plugins/chartjs/Chart.min.js"></script>
        <script src="__PUBLIC__/Dist/js/pages/dashboard2.js"></script>
        <script src="__PUBLIC__/plugins/iCheck/icheck.min.js"></script>
        <script src="__PUBLIC__/Dist/js/demo.js"></script>
        <script src="__PUBLIC__/plugins/ckeditor/ckeditor.js"></script>
        <script src="__PUBLIC__/Dist/js/demo.js"></script>
        <script src="__PUBLIC__/plugins/layer/layer.js"></script>
		<script src="__PUBLIC__/plugins/uploadify/jquery.uploadify.min.js"></script>
		<script type="text/javascript">
			//radio选中样式
			$('input').iCheck({
				labelHover: false,
				cursor: true,
				checkboxClass: 'icheckbox_square-blue',
				radioClass: 'iradio_minimal-blue',
				increaseArea: '20%'
			});
         

			$("#file").uploadify({
				"swf": "__PUBLIC__/plugins/uploadify/uploadify.swf",
				"buttonClass":"btn btn-primary",
				"line-height":"15px",
				"height":"30px",
				"fileObjName": "download",
				'fileTypeExts':  "*.gif;*.jpg;*.jpeg;*.png;",    //上传类型   
				"buttonText": "上传附件",
				"uploader": "{:U('File/upload')}",
				"width": 120,
				'removeTimeout': 1,
				"onUploadSuccess": function (file, data) {
					var url = JSON.parse(data);
					var src = url.src;
					var img_src = '__UPLOAD__/'+src;
					$('#filename').val(img_src);
					$("#image").attr("src",img_src);
					// $(".certificate_img").removeAttr("style");
					bannerYL();
				},
				'onFallback': function () {
					alert('未检测到兼容版本的Flash.');
				}
			});



			//上传头像弹窗区域
			function bannerYL() {
				layer.open({
					title: 'banner图预览',
					btn: [],
					area: ['400px', '820px'],
					type: 1,
					skin: 'layui-layer-lan', //样式类名
					closeBtn: 1, //显示关闭按钮
					anim: 2,
					shadeClose: true, //开启遮罩关闭
					content: $("#bannerYL")
                    
				});
			}

			  $('#bta').click(function(){
					var filepath = $('#filename').val();
					// alert(filepath); 
                   if( filepath == ''){
					   layer.msg('请上传图片');
					   return false;
				   }

                   $.post('{:U("Admin/Banner/updata")}',{filepath:filepath}, function($data) { 
					//    alert($data);
                          if($data){  
                          layer.msg('保存成功!');   
						  location.href = "{:U('Admin/Banner/detail')}";
                        //   window.location.reload();
						// document.location.reload();//当前页面 

						  }else{
						    layer.msg('保存发生错误!');     
						  }
				   },'json');
				});

			$('#btb').click(function(){
				layer.closeAll();
			});
		</script>
	</body>

</html>