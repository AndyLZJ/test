<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>我的课程_课程详情</title>
		<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
		<link rel="stylesheet" href="__PUBLIC__/Dist/css/comm.css">
		<link rel="stylesheet" href="__PUBLIC__/Css/bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/font-awesome-4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/ionicons-2.0.1/css/ionicons.min.css">
		<link rel="stylesheet" href="__PUBLIC__/plugins/jvectormap/jquery-jvectormap-1.2.2.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/css/comm.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/css/AdminLTE.min.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/css/skins/_all-skins.min.css">
		<link rel="stylesheet" href="__PUBLIC__/plugins/layer/skin/layer.css">
		<link rel="stylesheet" href="__PUBLIC__/plugins/iCheck/all.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/css/Mycourse.css">
		<!-- video player -->
		<link rel="stylesheet" href="__PUBLIC__/videoPlayer/video-js.css">
		<style type="text/css">
			.course_img{height:100%; }
			body,fieldset,legend,button,input,textarea{margin:0; padding:0; border:0; outline:0}
			a:hover,a:visited,a:link,a:active{text-decoration:none}
			sup{vertical-align:text-top}
			sub{vertical-align:text-bottom}
			legend{color:#000}
			fieldset,img{border:0}
			button,input,select,textarea{font-size:100%}
			table{border-collapse:collapse; border-spacing:0}
			.clear{clear:both; float:none; height:0; overflow:hidden}
			#pn{height:auto; background:#fff; margin:0 auto; padding:20px; padding-top:0}
			.list0{padding:20px 0; position:relative; border-top:1px solid #eee}
			.head{width:60px; float:left}
			.head img{width:60px; height:60px; border-radius:50%}
			.close{width:20px; height:20px; position:absolute; top:0; right:0; color:#696e78; font-size:14px; text-align:center; line-height:20px}
			.close:hover{color:#eb7350}
			.HF_content{line-height:20px; font-size:14px; margin-left:70px}
			.name{color:#eb7350}
			.pic{margin:5px 0}
			.good:after{clear:both; content:''; display:block; width:0; height:0; visibility:hidden}
			.good{*zoom:1; margin-top:5px}
			.date{float:left; color:#808080}
			.good a{float:right; color:#808080}
			.people{background:#f7f7f7; height:28px; line-height:28px; padding-left:10px; margin:5px 0}
			.comment:after{clear:both; content:''; display:block; width:0; height:0; visibility:hidden}
			.comment{*zoom:1; padding:10px 0; border-top:1px solid #eee}
			.comment-left{width:30px; float:left; display:inline; margin-right:10px}
			.comment-left img{width:30px; height:30px; border-radius:50%; border:1px solid #e0dddd; padding:2px}
			.comment-text{line-height:18px}
			.comment-text span{color:#eb7350}
			.comment-date{font-size:12px; line-height:14px; color:#ccc; position:relative}
			.comment-zan{position:absolute; right:95px; bottom:0; color:#808080}
			.comment-dele{position:absolute; right:0; bottom:0; color:#808080}
			.hf:after{clear:both; content:''; display:block; width:0; height:0; visibility:hidden}
			.hf{*zoom:1; margin-top:5px}
			.hf-text{border:1px solid #eee; display:block; height:35px; width:100%; padding:5px; resize:none; color:#ccc; font-size:12px}
			.hf-on .hf-text{height:60px; color:#333; border:1px solid #ff8140}
			.hf-btn{float:right; width:65px; height:26px; background:#f7f7f7; color:#ccc; font-size:12px; display:none}
			.hf-btn-on{background:#ff8140; color:#fff}
			.hf-nub{float:right; padding:3px 5px; color:#666; display:none}
			.hf-on .hf-btn{display:inline}
			.hf-on .hf-nub{display:inline}
			.huifu{right:45px}
			.FBmap{margin:auto}
			.FBmap textarea{resize:none; border:1px solid #c7c3c3; width:100%; min-height:100px; margin:auto; margin-top:5px}
			.FBmap textarea:focus{resize:none; border:1px solid #ff8140; width:100%; min-height:100px; margin:auto; margin-top:5px; padding:3px; font-size:16px}
			.FBbtn{float:right; color:white; cursor:pointer; height:35px; width:75px; margin-top:-5px; background-color:orangered}
			.course_cover{padding:1px; margin:0; width:706px; height:406px; border:2px solid #ccc;}
			.kejianFullScreen{position: absolute; right: 20px; margin-top: -35px; cursor:pointer; }
			.kejianSetFull{margin:0; border:0; padding:0; clear:both; position:fixed; right:0; top:0; left:0; bottom:0; z-index:99999; }
			
			/*课程问答*/
			.btn1{border: none; height: 2.0em; background-color: #3E8CD0; color: white; font-size: 1em; margin-top: 0.5em; width: 100%; border-radius: 0.5em; }
			.btn2{border: none; height: 2.0em; background-color: #e1e2e4; color: black; font-size: 1em; margin-top: 0.5em; width: 100%; border-radius: 0.5em; }
			.btn1:focus{outline: none; border: none; }
			.btn2:focus{outline: none; border: none; }
			.que_map{border: 1px solid #00acd6; padding: 0px 5px; border-radius: 5px; position: absolute; top: 0px; width: 100%; }
			.que_gundong{border: 1px solid #00acd6; padding: 0px 5px; border-radius: 5px; position: fixed; top: 0px; width: 32%; background:#fff; }
			.chap_string{padding:0 8px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
			
		</style>
	</head>
	<body>
		<!--内容区域顶栏面包屑开始-->
		<section class="content-header">
			<h1 class="info_title">
				 <if condition="$project_id neq 'true' and $project_id neq 'false'">必修课程<else/>选修课程</if>
				        <small>/<if condition="$base.course_way eq 0">在线课程详情<else/>面授课程详情</if></small>
				    </h1>
			<ol class="breadcrumb">
				<li>
					<a href="javascript:void(0)" onclick="JavaScript:history.back(-1)" class="text-grey"><i class="fa fa-mail-reply-all"></i>返回</a>
				</li>
			</ol>
		</section>
		<!--内容区域顶栏面包屑结束-->
		<section class="content">
			<div class="box">
				<div class="box-body">
					<!--内容开始-->
					<div class="box-header with-border">
						<div class="col-sm-12" style="width:750px;">
							<h4 class="float_l">{$base.course_name}</h4>
							<span class="ml10 label label-info">课程分类：{$base.cat_name}</span>
							<span class="ml5 label label-success">授课讲师：{$base.lecturer_name}</span>
							<span class="ml5 label label-warning">课程时长：{$base.course_time}分钟</span>
						</div>
						<!--公开课程显示该按钮-->
						<if condition="$base.course_way eq 0">
						<label class="col-sm-3 control-label" style="width:150px;">
							<div >
								<span class="float_l">所属层次：</span>
								<span><if condition="$base.arrangement_id eq 1">基础层<elseif condition="$base.arrangement_id eq 2"/>中间层<elseif condition="$base.arrangement_id eq 3"/>核心层<elseif condition="$base.arrangement_id eq 4"/>专业层<else /></if></span>
							</div>
						</label>
						<label class="col-sm-3 control-label" style="width:225px;">
                            <div id="startone3" >
                            	<span class="float_l">课程评价：</span>
						        <div class="star_score float_l" data-param="3"></div>
						    </div>
						</label>
						<label class="col-sm-3 control-label" style="width:225px;">
                            <div id="startone4" >
                            	<span class="float_l">讲师评价：</span>
						        <div class="star_score float_l" data-param="3"></div>
						    </div>
						</label>
						</if>
						<if condition="$project_id eq 'true'">
							<if condition="$base.status eq 0">
								<label class="control-label float_r mr10" >
									<div>
										<span class="float_l"><a href="{:U('admin/rs_course/addcourse',array('id'=>$base['id']))}">编辑</a></span>
									</div>
								</label>
							</if>

							<label class="control-label float_r mr10" style="margin-left:10px;">
								<div>
									<if condition="empty($course_bak) ">
											<span class="float_l"><a class="btn btn-success" href="#" onclick="HistoryVersion()">历史版本</a></span>
										<else />
											<span class="float_l"><a class="btn btn-success" href="{:U('admin/rs_course/HistoryVersion',array('id'=>$base['id']))}">历史版本</a></span>
									</if>
								</div>
							</label>

							<label class="control-label float_r">
								<div>
									<span class="float_l">状态：</span>
									<div class=" float_l" ><if condition="$base.status eq 0">待审核<elseif condition="$base.status eq 1"/>已通过<else />已拒绝</if></div>
								</div>
							</label>
						</if>
						<!--加入我的课程按钮-->
						<if condition="$base.is_public eq 1">
							<if condition="$base.joinStatus eq 0">
							<div class="col-sm-3" style="width:180px;">
								<a type="button" class="addCourse btn btn-primary btn-sm pull-right"> 
								    <i class="fa fa-tags mr5" aria-hidden="true"></i>加入我的课程
								</a>
							</div>
							</if>
						</if>
						<if condition="$whetherteach eq 1">
						<a href="__MODULE__/{$kaoqin}" type="button" class="btn btn-primary btn-sm pull-right "> <i class="fa fa-edit mr5" aria-hidden="true"></i>考勤统计</a>
						</if>
					</div>
					
					<!--课程封面及主要信息区域开始-->
					<div class="row box-body mt10">
						<!--左侧封面课程区域-->
						<!-- 课程封面 -->
						<div class="col-sm-3 course_cover" id="cover_box" <if condition="$base.media_src neq ''"> style="display:none; " <else/> style="display:block; " </if>>
							<img class="width_10 course_img" src="{$base.course_cover}" onerror="this.src='__PUBLIC__/Dist/img/class2.png'"/>
						</div>
						<!-- 视频播放 -->
						<div class="col-sm-3 course_cover" id="video_box" style="display:none; ">
							<video id="my-video" class="video-js vjs-big-play-centered" controls 
							width="700" height="400" poster="{$base.course_cover}" 
							data-setup='{}'>
							    <p class="vjs-no-js">要查看此视频，请启用JavaScript</p>
							</video>
						</div>
						<!-- 课件播放 -->
						<div class="col-sm-3 course_cover" id="kejian_box" style="display:none;">
							<iframe src="" width="100%" height="100%"></iframe>
							<div class="kejianFullScreen"><img src="__PUBLIC__/Images/full_screen_ico.png"/></div>
						</div>
						
						<if condition="$base.course_way eq 1">
						<!--右侧课程信息及审核区域-->
						<div class="col-sm-9" style="width:500px">
							<div class="row mb20">
								<label class="col-sm-12 control-label">
									<div id="" >
										<span class="float_l">所属层次：</span>
										<span><if condition="$base.arrangement_id eq 1">基础层<elseif condition="$base.arrangement_id eq 2"/>中间层<elseif condition="$base.arrangement_id eq 3"/>核心层<elseif condition="$base.arrangement_id eq 4"/>专业层<else /></if></span>
									</div>
								</label>
							</div>
							<div class="row mb20">
								<label class="col-sm-12 control-label">培训讲师：<span id="#">{$base.lecturer_name}</span> </label>
							</div>
							<if condition="$base.start_time neq ''">
							<div class="row mb20">
								<label class="col-sm-12 control-label">培训时间：<span id="#">{$base.start_time} 至 {$base.end_time}</span></label>
							</div>
							</if>
							<if condition="$base.location neq ''">
							<div class="row mb20">
								<label class="col-sm-12 control-label">面授地址：<span id="#">{$base.location}</span></label>
							</div>
							</if>
							<!-- <div class="row mb20">
								<label class="col-sm-12 control-label">限制人数：<span id="#">不公开</span></label>
							</div> -->
							<div class="row mb20">
								<label class="col-sm-12 control-label">
                                	<div id="startone1" >
                                	    <span class="float_l">课程评价：</span>
								        <div class="star_score float_l"></div>
								    </div>
								</label>
							</div>
							<div class="row mb20">
								<label class="col-sm-12 control-label">
                                	<div id="startone2">
                                	    <span class="float_l">讲师评价：</span>
								        <div class="star_score float_l"></div>
								    </div>
								</label>
							</div>

						</div>
						<!--右侧课程信息及审核区域区域-->
						</if>
						<if condition="$base.course_way eq 0">
						<!--右侧课程信息及审核区域-->
						<div class="col-sm-6">
							<div class="box">
								<!-- /.box-header -->
								<div class="box-body no-padding chapterList">
									<table class="table">
										<tbody>
											<tr>
												<th style="width: 10px"></th>
												<th>目录</th>
												<th width="80">进度</th>
												<th width="200">操作</th>
											</tr>
											<!-- <tr class="">
												<td></td>
												<td><i class="mr5 fa fa-file-video-o"></i>--</td>
												<td><span class="jindu">--</span></td>
												<td>
													<input type="hidden" class="timelen" value="{$chap.timelen}"/>
													<input type="hidden" class="fileName" value="{$chap.name}"/>
													<input type="hidden" class="fileType" value="{$chap.fileType}"/>
													<input type="hidden" class="fileSrc" value="{$chap.src}"/>
													<button class="startStudyKejian btn btn-primary btn-sm">开始学习</button>
												</td>
											</tr> -->
											<foreach name="base.chapter" item="chap" key="k">
												<tr>
													<td>{$key + 1}.</td>
													<if condition="$chap['fileType'] eq video">
													<td><i class="mr5 fa fa-file-video-o"></i>{$chap.name}</td>
													<elseif condition="$chap['fileType'] eq audio"/>
													<td><i class="mr5 fa fa-file-audio-o"></i>{$chap.name}</td>
													<elseif condition="$chap['fileType'] eq ppt"/>
													<td><i class="mr5 fa fa-file-powerpoint-o"></i>{$chap.name}</td>
													<elseif condition="$chap['fileType'] eq doc"/>
													<td><i class="mr5 fa fa-file-word-o"></i>{$chap.name}</td>
													<elseif condition="$chap['fileType'] eq xls"/>
													<td><i class="mr5 fa fa-file-excel-o"></i>{$chap.name}</td>
													<elseif condition="$chap['fileType'] eq pdf"/>
													<td><i class="mr5 fa fa-file-pdf-o"></i>{$chap.name}</td>
													<elseif condition="$chap['fileType'] eq kejian"/>
													<td><i class="mr5 fa fa-cubes"></i>{$chap.name}</td>
													<else/>
													<td><i class="mr5 fa fa-file-image-o"></i>{$chap.name}</td>
													</if>
													<td><span class="jindu">{$chap.jindu}%</span></td>
													<td>
														<input type="hidden" class="timelen" value="{$chap.timelen}"/>
														<input type="hidden" class="fileName" value="{$chap.name}"/>
														<input type="hidden" class="fileType" value="{$chap.fileType}"/>
														<input type="hidden" class="fileSrc" value="{$chap.src}"/>
														<if condition="($chap['fileType'] eq video) or ($chap['fileType'] eq audio)">
														<button class="startStudy btn btn-primary btn-sm">开始学习</button>
														<elseif condition="$chap['fileType'] eq kejian"/>
														<button class="startStudyKejian btn btn-primary btn-sm">开始学习</button>
														<else/>
														<a class="startStudy btn btn-primary btn-sm" href="javascript:void(0)" target="_blank">点击下载</a>
														<a title="{$k}" class="startPreview btn btn-primary btn-sm" href="javascript:void(0)" >点击预览</a>
														<!--<a title="{$k}" id="fview" class="" href="javascript:void(0)" >cdsc</a>-->
														</if>
													</td>
												</tr>
											</foreach>
											
										</tbody>
									</table>
								</div>
								<!-- /.box-body -->
							</div>
						</div>
						<!--右侧课程信息及审核区域区域-->
						</if>
					</div>
					<!--课程封面及主要信息区域结束-->
					<!--项目切换标签开始-->
					<div class="box-body">
						<div class="nav-tabs-custom">
							<ul class="nav nav-tabs">
								<li <if condition="$type eq 1"> class="active" </if> >
									<a href="__ACTION__/type/1/project_id/{$project_id}/course_id/{$course_id}">介绍</a>
								</li>
								<li <if condition="$type eq 2"> class="active" </if>>
									<a href="__ACTION__/type/2/project_id/{$project_id}/course_id/{$course_id}">评价</a>
								</li>
								<li <if condition="$type eq 3"> class="active" </if>>
									<a href="__ACTION__/type/3/project_id/{$project_id}/course_id/{$course_id}">笔记</a>
								</li>
								<li <if condition="$type eq 4"> class="active" </if>>
									<a href="__ACTION__/type/4/project_id/{$project_id}/course_id/{$course_id}">问答</a>
								</li>
							</ul>
							<div class="tab-content">
								<!----------------------------------------------我的课程介绍列表开始-->
								<div class="tab-pane <if condition='$type eq 1'> active </if>" id="referral">
									<div class="box-body">
										<div class="row">
											<div class="col-sm-12">
												<form class="form-horizontal">
													<div class="box-body">
														<if condition="$base.course_way eq 0">
															<!--内部讲师字段开始-->
															<!-- <div class="form-group">
																<label for="" class="pull-left ml15">培训时间：</label>
	
																<div class="col-sm-6">
																	<label for=""><span id="#">{$base.start_time} <if condition="$base.start_time neq ''">至</if> {$base.end_time}</span></label>
																</div>
															</div> -->
															<!--内部讲师字段开始-->
															<if condition="$base.lecturer_name neq ''">
															<div class="form-group">
																<label for="" class="pull-left ml15">培训讲师：</label>
	
																<div class="col-sm-6">
																	<label for=""><span id="#">{$base.lecturer_name}</span></label>
																</div>
															</div>
															</if>
															<!--  分隔符开始-->
															<div class="box-header with-border mb20"></div>
															<!--  分隔符结束-->
														</if>
														<div class="form-group">
															<label for="" class="pull-left ml15">课程介绍：</label>

															<div class="col-sm-6">
																<label for=""><span id="#">{$detail.course_intro}</span></label>
															</div>
														</div>
														<!--  分隔符开始-->
														<div class="box-header with-border mb20"></div>
														<!--  分隔符结束-->
														<div class="form-group">
															<label for="" class="pull-left ml15">课程目标：</label>
															<div class="col-sm-6">
																<label for="" class=""><span id="#">{$detail.course_aim}</span></label>
															</div>
														</div>
														<!--  分隔符开始-->
														<div class="box-header with-border mb10"></div>
														<!--  分隔符结束-->

														<div class="form-group">
															<label for="inputEmail3" class="pull-left ml15">课程大纲：</label>
														
															<div class="col-sm-6">
																<label for="" class=""><span id="#">{$detail.course_outline}</span></label>
															</div>
														</div>
													</div>
												</form>
											</div>
										</div>
									</div>
									<!--我的列表结束-->
								</div>
								
								<!-------------------------------------------------------课程评价开始-->
								<div class="tab-pane <if condition='$type eq 2'> active </if>" id="KCeva">
									<div class="box-body">
										<div class="row">
											<div class="course_comment_editor FBmap" style="display:none; ">
												<!--富文本编辑器-->
												<script id="container" name="content" type="text/plain" style="height: 160px;width:100%;margin: 10px 0px 10px 0px;">
													这里写你的初始化内容
												</script>
												<div style="height: 45px;">
													<button class="FBbtn" onclick="FaBu()">添加评价</button>
												</div>
											</div>
											<if condition="$base.joinStatus eq 0">
											<p style="font-size:20px; color:#bbb; ">加入到我的课程后才可以评价哦~~</p>
											</if>
											<ul id="pn">
												<!-- 初始文本框区域-->
												<!-- 初始文本框区域结束-->
												<foreach name="commentList.list" item="clist">
												<li class="list0">
													<if condition="($clist.del_status eq 1) OR ($manager eq 'true')"><a class="close" href="javascript:;" style="opacity: 0.6;">X</a></if>
													<input type="hidden" value="{$clist.id}" class="comment_id"/>
													<div class="head"><img src="{$clist.avatar}" onerror="this.src='__PUBLIC__/Dist/img/avatar5.png'"/></div>
													<div class="HF_content">
														<p class="text"><span class="name">{$clist.username}：</span>{$clist.comment_content}</p>
														<div class="good"><span class="date">{$clist.comment_time}</span>
															<if condition="$clist.zan_status eq 1">
															<a class="dzan" href="javascript:;">取消赞</a>
															<else/>
															<a class="dzan" href="javascript:;">赞</a>
															</if>
															<notempty name="clist.sub_list">
																<a href="javascript:void(0);" style="color: red;float:right; margin-right: 50px;"><span class="closeSub" >收起回复▲</span></a>
															</notempty>
														</div>
														<div class="people" <if condition="$clist.zan == 0"> style="display:none;" </if> total="{$clist.zan}">{$clist.zan}人觉得很赞</div>
														<div class="comment-list">
															<!-- 子评论开始 -->
															<foreach name="clist.sub_list" item="sublist">
															<div class="comment" user="self">
																<div class="comment-left"><img src="{$sublist.avatar}" onerror="this.src='__PUBLIC__/Dist/img/avatar5.png'"/></div>
																<div class="comment-right">
																	<div class="comment-text"><span class="user">{$sublist.username}：</span><notempty name="sublist.reply_user">回复 {$sublist.reply_user}：</notempty>{$sublist.comment_content}</div>
																	<div class="comment-date">{$sublist.comment_time}
																		<if condition="($sublist.del_status eq 1) OR ($manager eq 'true')">
																		<a style="right:0px;" class="comment-dele" rel="{$sublist.id}" href="javascript:;">删除</a>
																		<else/>
																		<a style="right:0px;" class="comment-dele" rel="{$sublist.id}" href="javascript:;">回复</a>
																		</if>
																	</div>
																</div>
															</div>
															</foreach>
															<!-- 子评论结束 -->
														</div>
														<div class="hf">
															<textarea type="text" class="hf-text" autocomplete="off" maxlength="100">请输入您的评论…</textarea>
															<button class="hf-btn">回复</button>
														</div>
													</div>
												</li>
												</foreach>

											</ul>
										</div>
									</div>
									<!--分页开始-->
									<div class="row">
										<div class="dataTables_paginate float_r mr15">
											<!-- 分页html -->
											{$commentList.pageNav}
										</div>
									</div>
									<!--分页结束	-->
									<!--课程评价结束-->
								</div>

								<!----------------------------------------------------  课程笔记区域开始-->
								<div class="tab-pane <if condition='$type eq 3'> active </if>" id="note">
									<div class="box-body">
										<div class="row">
											<div class="course_note_editor FBmap" style="display:none;">
												<textarea id="CentontBJ" placeholder="好记性不如小笔记，快来记下学习中的点滴………………"></textarea>
												<div style="height: 45px;">
												<button class="FBbtn" onclick="FaBJ()">添加笔记</button>
												<span class="float_r mr15 mt5" ><input class="is_public" type="checkbox" name="check" value="公开" /> <span class="ml5">公开</span> </span>
												</div>
											</div>
											
											<if condition="$base.joinStatus eq 0">
											<p style="font-size:20px; color:#bbb; ">加入到我的课程后才可以写笔记哦~~</p>
											</if>
											
											<ul id="pnBJ">
												<foreach name="note" item="vo">
												<li class="list0">
													<input type="hidden" value="{$vo.id}" class="note_id">
													<if condition="$vo.del_status eq 1"><a class="close" href="javascript:;" style="opacity: 0.6;">X</a></if>
													<div class="head"><img src="{$vo.avatar}" onerror="this.src='__PUBLIC__/Dist/img/avatar5.png'"/></div>
													<div class="HF_content">
														<p class="text"><span class="name">{$vo.username}：</span>{$vo.note_content}</p>
														<div class="good"><span class="date">{$vo.time}</span>
														</div>
													</div>
												</li>
												</foreach>
											</ul>
										</div>

									</div>
									<!--分页开始-->
									<div class="row">
										<div class="dataTables_paginate float_r mr15">
											<!-- 分页html -->
											{$pageNav}
										</div>
									</div>
									<!--分页结束	-->
									
									<!--课程笔记区域结束-->
								</div>
								
								<!--------------------------------------------- 课程问答开始 -->
								<div class="tab-pane <if condition='$type eq 4'> active </if>" id="Question">
									<!--总回答数量-->
									<div class="box-header with-border">
										<p class="box-title">共<span class="text-red">{$quesNum}条</span>回答</p>
									</div>
									<div class="row mt10 ">
										<div class="col-sm-2">
											<a href="__ACTION__/type/4/project_id/{$project_id}/course_id/{$course_id}"><button name="btn_name" id="1" class="<if condition='$chapIndex eq 0'>btn1<else/>btn2</if>">全部问题</button></a>
										</div>
										
										<foreach name="base.chapter" item="chap" key="chapOrder">
										<div class="col-sm-2">
											<a href="__ACTION__/type/4/project_id/{$project_id}/course_id/{$course_id}/chapIndex/{$chapOrder + 1}">
												<button name="btn_name" title="{$chap.name}" class="chap_string <if condition='($chapOrder + 1) eq $chapIndex'>btn1<else/>btn2</if>">{$chap.name}</button>
											</a>
										</div>
										</foreach>
									</div>
									<div class="row mt10">
										<!--左侧问题展示区域-->
										<div class="col-sm-8 quesListCon">
											<foreach name="ques" item="quesData">
											<div class="box-header with-border">
												<h3 class="box-title font_bold">{$quesData.title}</h3>
												<div class="mt10">
													<a href="__CONTROLLER__/answerPage/ques_id/{$quesData.id}" class="btn btn-info btn-sm  mb10">我来回答</a>
													<span class=" float_r"><a href="__CONTROLLER__/answerPage/ques_id/{$quesData.id}" class="mr10">{$quesData.answer_num}条回复>></a><span  class="mr10">{$quesData.username}</span> {$quesData.add_time}</span>
												</div>
											</div>
											</foreach>
										</div>
										<!--右侧提问区域-->
										<div class="col-sm-4">
											<div class="que_map" id="que_map">
												<h3 class="box-title font_bold text-center mt10">我要提问</h3>
												<div class="form-group">
													<label><span class="text-red">*</span>问题：</label>
													<textarea class="form-control quesCon" rows="8" placeholder="请输入您的问题 ..."></textarea>
												</div>
												<div class="form-group">
													<label><span class="text-red">*</span>标题：</label>
													<textarea class="form-control quesTitle" rows="3" placeholder="给问题起一个标题吧 ..."></textarea>
												</div>
												<div class="text-center">
													<input type="button" class="addQues btn btn-info form-group_but  mb10" value="发布问题"/>
												</div>
											</div>
										</div>
									</div>
									
									<!--分页开始-->
									<div class="row">
										<div class="dataTables_paginate float_r mr15">
											<!-- 分页html -->
											{$pageNav}
										</div>
									</div>
									<!--分页结束	-->
									
								</div>
								<!-- 课程问答结束 -->
								
								
							</div>
						</div>
						<!--项目切换标签结束-->
						<!--内容結束-->
					</div>
				</div>
		</section>
		<div id="downframe" style="display:none;"></div>
		<input type="hidden" id="pd" value="1" />
		<input type="hidden" id="course_score" value="{$base.course_score}"/>
		<input type="hidden" id="lecturer_score" value="{$base.lecturer_score}"/>
		<input type="hidden" id="joinStatus" value="{$base.joinStatus}"/>
		<input type="hidden" id="ogtype" value="{$ogtype}"/>
		<input type="hidden" id="sub_comment_id" value=""/>
		<input type="hidden" id="newReplyId" value=""/>
		<script src="__PUBLIC__/plugins/jQuery/jquery-2.2.3.min.js"></script>
		<script src="__PUBLIC__/Css/bootstrap/js/bootstrap.min.js"></script>
		<script src="__PUBLIC__/plugins/fastclick/fastclick.js"></script>
		<script src="__PUBLIC__/Dist/js/app.min.js"></script>
		<script src="__PUBLIC__/plugins/sparkline/jquery.sparkline.min.js"></script>
		<script src="__PUBLIC__/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
		<script src="__PUBLIC__/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
		<script src="__PUBLIC__/plugins/slimScroll/jquery.slimscroll.min.js"></script>
		<script src="__PUBLIC__/plugins/chartjs/Chart.min.js"></script>
		<script src="__PUBLIC__/plugins/iCheck/icheck.min.js"></script>
		<script src="__PUBLIC__/plugins/ckeditor/ckeditor.js"></script>
		<script src="__PUBLIC__/Dist/js/demo.js"></script>
		<script src="__PUBLIC__/plugins/layer/layer.js"></script>
		<script src="__PUBLIC__/Dist/js/startScore.js"></script>
		<script src="__PUBLIC__/Dist/js/utf8-php/ueditor.config.js"></script>
		<script src="__PUBLIC__/Dist/js/utf8-php/ueditor.all.js"></script>
		<script src="__PUBLIC__/Dist/js/utf8-php/lang/zh-cn/zh-cn.js"></script>
		
		<!-- video player -->
		<script src="__PUBLIC__/videoPlayer/videojs-ie8.min.js"></script>
		<script src="__PUBLIC__/videoPlayer/video.min.js"></script>
		<script type="text/javascript">
			//radio选中样式
			$('input').iCheck({
				labelHover: false,
				cursor: true,
				checkboxClass: 'icheckbox_square-blue',
				radioClass: 'iradio_minimal-blue',
				increaseArea: '20%'
			});
			
			//课程问答部分
			//监控滚动条位置
			$(window).scroll(function(event){
				var winPos = $(window).scrollTop();
				var remove="";
				var add="";
				if(winPos>700){
					remove="que_map";
					add="que_gundong";
				}else{
					remove="que_gundong";
					add="que_map";
				}
				$("#que_map").removeClass(remove);
				$("#que_map").addClass(add);
		    });
			
			//发布问题
			$(".addQues").click(function(){
				var title = $(".quesTitle").val();
				var content = $(".quesCon").val();
				title = encodeURIComponent(title);
				content = encodeURIComponent(content);
				var course_id = "{$course_id}";
				var project_id = "{$project_id}";
				var chapIndex = "{$chapIndex}";
				$.ajax({
					type: "post",
					url: "__CONTROLLER__/newQues",
					data: "course_id="+course_id+"&project_id="+project_id+"&chapIndex="+chapIndex+"&title="+title+"&content="+content,
					dataType: "json",
					success: function(data){
						if(data.code == 1000){
							layer.msg('问题已发布', {
								time: 800, //2s后自动关闭
							});
							
							var html = '<div class="box-header with-border">';
							html += '<h3 class="box-title font_bold">'+$(".quesTitle").val()+'</h3><div class="mt10">';
							html += '<a href="__CONTROLLER__/answerPage/ques_id/'+data.last_id+'" class="btn btn-info btn-sm  mb10">我来回答</a>';
							html += '<span class=" float_r"><a href="__CONTROLLER__/answerPage/ques_id/'+data.last_id+'" class="mr10">0条回复>></a><span  class="mr10">{$username}</span> '+data.curr_time+'</span></div></div>';
							$(".quesListCon").append(html);
							/* setTimeout(function(){
								window.location.href = "__CONTROLLER__/answerPage/ques_id/"+data.last_id;	
							}, 1000); */
						}else{
							layer.alert(data.message);
						}
					}
				});
			});
			
			//富文本框
			var ue = UE.getEditor('container', {
				toolbars: [
					['fullscreen','emotion' ,'|','simpleupload','|','bold','|','forecolor']//定义要显示的工具栏图标
				],
				autoHeightEnabled: false, //高度固定出现滚动条
				autoFloatEnabled: false,
				wordCount:false,//字符统计隐藏
				elementPathEnabled: false,//元素路径隐藏 true为显示
				autoClearinitialContent :true,//初始内容点击后消失
			});
			var ue = UE.getEditor('container'); //初始化对象  
			$(document).ready(function() {
				var ue = UE.getEditor('container');
				var proinfo = $("#container").text("在这里畅所欲言吧......");//初始化内容为
			});
			
			if($("#joinStatus").val() == 1){
				$(".course_comment_editor").show();
				$(".course_note_editor").show();
			}else{
				$(".dzan").remove();
				$(".comment-dele").remove();
				$(".hf-text").remove();
			}
			
			//判断是否可以评分
			var ogtype = $("#ogtype").val();
			$("#startone1").on("click",".star_score",function(){
				if(ogtype == 1){
					layer.alert("您不能给自己打分");
					setTimeout(function(){
						showScore();
					},100);
				}else{
					giveScore($(this), 1);
				}
			});
			$("#startone2").on("click",".star_score",function(){
				if(ogtype == 1){
					layer.alert("您不能给自己打分");
					setTimeout(function(){
						showScore();
					},100);
				}else{
					giveScore($(this), 2);
				}
			});
			$("#startone3").on("click",".star_score",function(){
				if(ogtype == 1){
					layer.alert("您不能给自己打分");
					setTimeout(function(){
						showScore();
					},100);
				}else{
					giveScore($(this), 1);
				}
			});
			$("#startone4").on("click",".star_score",function(){
				if(ogtype == 1){
					layer.alert("您不能给自己打分");
					setTimeout(function(){
						showScore();
					},100);
				}else{
					giveScore($(this), 2);
				}
			});
			
			function giveScore(ele, type){
				var joinStatus = $("#joinStatus").val();
				if(joinStatus == 0){
					layer.alert("请先添加课程再评价");
					setTimeout(function(){
							showScore();
					},100);
				}else{
					var score = ele.find(".clibg").index() + 1;
					var course_id = "{$course_id}";
					$.ajax({
						type: "post",
						url: "__CONTROLLER__/giveScore",
						data: "course_id="+course_id+"&score="+score+"&type="+type,
						dataType: "json",
						success: function(data){
							if(data.code == 1000){
								layer.alert("已打分");
								if(type == 1){
									$("#course_score").val(data.avgScore);
								}else{
									$("#lecturer_score").val(data.avgScore);
								}
								setTimeout(function(){
										showScore();
								},100);
							}else{
								layer.alert(data.message);
								setTimeout(function(){
										showScore();
								},100);
							}
						}
					});
				}
			}
			
			//显示分数
			scoreFun($("#startone1"),{fen_d:23,ScoreGrade:5});
			scoreFun($("#startone2"),{fen_d:23,ScoreGrade:5});
			scoreFun($("#startone3"),{fen_d:23,ScoreGrade:5});
			scoreFun($("#startone4"),{fen_d:23,ScoreGrade:5});
			showScore();
			function showScore(){
				var courseComment = $("#course_score").val();
				$("#startone1 .star_score  a").removeClass("clibg");
				$("#startone3 .star_score  a").removeClass("clibg");
				if(courseComment > 0){
					courseComment = courseComment - 1;
					$("#startone1 .star_score  a").eq(courseComment).addClass("clibg");
					$("#startone3 .star_score  a").eq(courseComment).addClass("clibg");
				}
				
				var lecturerComment = $("#lecturer_score").val();
				$("#startone2 .star_score  a").removeClass("clibg");
				$("#startone4 .star_score  a").removeClass("clibg");
				if(lecturerComment > 0){
					lecturerComment = lecturerComment - 1;
					$("#startone2 .star_score  a").eq(lecturerComment).addClass("clibg");
					$("#startone4 .star_score  a").eq(lecturerComment).addClass("clibg");
				}
			}

			//课程评价js
			//在页面加载完后立即执行多个函数。
			function addloadEvent(func) {
				var oldonload = window.onload;
				if(typeof window.onload != "function") {
					window.onload = func;
				} else {
					window.onload = function() {
						if(oldonload) {
							oldonload();
						}
						func();
					}
				}
			}
			addloadEvent(b);

			function b(){
				var pn = document.getElementById("pn");
				var lists = pn.children;
				//删除当前节点
				function remove(node) {
					node.parentNode.removeChild(node);
				}
				//上面的点赞
				function praisebox(box, el) {
					//获取赞数量容器
					var praise = box.getElementsByClassName("people")[0];
					//获取容器当前total值
					var total = parseInt(praise.getAttribute("total"));
					//获取点击的innerHTML
					var txt = el.innerHTML;
					//创建一个新的total存储用
					var newtotal;
					//判断点击的文字内容
					if(txt == "赞") {
						//total值+1 因为我还没点击赞，所以要点击的时候就多了一个人 total+1
						newtotal = total + 1;
						//判断赞数量 把相应文字放到赞容器里
						praise.innerHTML = newtotal == 1 ? "我觉得很赞" : "我和" + total + "个人觉得很赞";
						el.innerHTML = "取消赞";
					} else {
						//反之total值-1
						newtotal = total - 1;
						praise.innerHTML = newtotal == 0 ? "" : newtotal + "个人觉得很赞";
						el.innerHTML = "赞";
					}
					//更新total值
					praise.setAttribute("total", newtotal);
					//如果没有人点赞容器隐藏
					praise.style.display = (newtotal == 0) ? "none" : "block";
				}
				
				//回复评论
				function reply(box) {
					//获取评论框
					var textarea = box.getElementsByTagName("textarea")[0];
					//return false;
					//获取包含所有评论的容器
					var comment = box.getElementsByClassName("comment-list")[0];
					//创建新的评论div
					var div = document.createElement("div");
					//赋类名
					div.className = "comment";
					//设置属性
					div.setAttribute("user", "self");
					var del_sub_id = $("#newReplyId").val();
					//获取每条评论的innerHTML结构，每次只替换textarea的输入内容和 当前发送时间
					var html = '<div class="comment-left">' + '<img src="{$avatar}" alt=""/>' + '</div>' +
						'<div class="comment-right">' +
						'<div class="comment-text"><span class="user">{$username}：</span>' + textarea.value + '</div>' +
						'<div class="comment-date">' +
						getTime() +
						'<a class="comment-dele" rel="'+del_sub_id+'" href="javascript:;">删除</a>' +
						//'<a style="right:45px;" class="comment-dele" href="javascript:;">回复</a>' +
						'</div>' +
						'</div>';
					//插入到新建的评论div
					div.innerHTML = html;
					//把新评论插入到评论列表
					comment.appendChild(div);
					//评论后初始化textarea输入框
					textarea.value = "请输入您的评论…";
					textarea.parentNode.className = "hf";
				}

				//操作回复
				function operateReply(el) {
					//每条评论
					var comment = el.parentNode.parentNode.parentNode;
					//整个状态
					var box = comment.parentNode.parentNode.parentNode;
					//评论框
					var textarea = box.getElementsByTagName("textarea")[0];
					//名字
					var user = comment.getElementsByClassName("user")[0];
					//点击的innerHTML
					var txt = el.innerHTML;
					//判断当前点击的是否为回复
					if(txt == "回复") {
						//评论框触发焦点事件 也就是变高
						textarea.onfocus();
						//内容变为回复+当前人的名字
						textarea.value = "回复 " + user.innerHTML;
						//调用键盘事件
						textarea.onkeyup();
					} else {
						//否则就是删除节点
						remove(comment);
					}

				}
				
				$(".comment-right").on("click",".comment-dele", function(){
					var sub_comment_id = $(this).attr("rel");
					$("#sub_comment_id").val(sub_comment_id);
				});
				
				//遍历所有状态消息
				for(var i = 0; i < lists.length; i++) {
					//全部事件代理
					lists[i].onclick = function(e) {
						//获取当前点击事件
						var e = e || window.event;
						var el = e.srcElement;
						if(!el) {
							el = e.target; //兼容火狐
						}
						//判断点击的类名
						switch(el.className) {
							//关闭整个状态
							case "close":
								//主评论删除
								$(this).closest(".list0").addClass("is_del_main");
								layer.confirm("是否删除该评论？");
								$(".layui-layer-btn0").click(function(){
									var comment_id = $(".is_del_main").find(".comment_id").val();
									$.ajax({
										type: "post",
										url: "__CONTROLLER__/delComment",
										data: "comment_id="+comment_id,
										dataType: "json",
										success: function(data){
											if(data.code == 1000){
												remove(el.parentNode);
												$(".course_comment_editor").show();
											}else{
												layer.alert(data.message);
											}
										}
									});
								});
								break;
								//上面的点赞
							case "dzan":
								var comment_id = $(this).closest(".list0").find(".comment_id").val();
								if(!comment_id){
									layer.alert("未获取到评价id");
									return false;
								}
								
								var opText = $(this).closest(".list0").find(".dzan").text();
								var praise_status = 1;
								if(opText == "取消赞"){
									praise_status = 0;
								}
								$.ajax({
									type: "post",
									url: "__CONTROLLER__/makePraise",
									data: "comment_id="+comment_id+"&praise_status="+praise_status,
									dataType: "json",
									success: function(data){
										if(data.code == 1000){
											praisebox(el.parentNode.parentNode.parentNode, el);
										}else{
											layer.alert(data.message);
										}
									}
								});
								break;
								//回复评论
							case "hf-btn hf-btn-on":
								var content = $(this).closest(".list0").find("textarea").val();
								content = $.trim(content);
								if(!content || content == ""){
									layer.alert("请填写回复内容");
									return false;
								}
								
								//回复内容去掉：回复 xxx
								//没有回复人，说明是直接回复一级评论
								var comment_id = $(this).closest(".list0").find(".comment_id").val();
								if(content.indexOf("回复") > -1){
									//使用二级回复人的评论id
									comment_id = $("#sub_comment_id").val();
									
									var dealCon = content.split("：");
									content = dealCon[1];
								}
								
								if(!comment_id){
									layer.alert("未获取到评价id");
									return false;
								}
								
								$.ajax({
									type: "post",
									url: "__CONTROLLER__/reply",
									data: "comment_id="+comment_id+"&content="+encodeURIComponent(content),
									dataType: "json",
									success: function(data){
										if(data.code == 1000){
											$("#newReplyId").val(data.last_id);
											reply(el.parentNode.parentNode.parentNode);
										}else{
											layer.alert(data.message);
										}
									}
								});
								break;
								//回复子评论 or 删除子评论
							case "comment-dele":
								if(el.innerHTML == "删除"){
									var comment_id = $("#sub_comment_id").val();
									$.ajax({
										type: "post",
										url: "__CONTROLLER__/delComment",
										data: "comment_id="+comment_id,
										dataType: "json",
										success: function(data){
											if(data.code == 1000){
												operateReply(el);
											}else{
												layer.alert(data.message);
											}
										}
									});
								}else{
									operateReply(el);
								}
								break;
						}
					}
					var textarea = lists[i].getElementsByClassName("hf-text")[0];
					//焦点事件
					textarea.onfocus = function() {
							this.parentNode.className = 'hf hf-on';
							this.value = this.value == '请输入您的评论…' ? '' : this.value;
						}
					//失焦事件
					textarea.onblur = function() {
							if(this.value == '') {
								this.parentNode.className = 'hf';
								this.value = '请输入您的评论…';
							}
						}
					//键盘事件
					textarea.onkeyup = function() {
						var len = this.value.length;
						var textParentNode = this.parentNode;
						var textBtn = textParentNode.children[1];
						//var textNub = textParentNode.children[2];
						if(len == 0 /*|| len>100*/ ) {
							textBtn.className = "hf-btn";
						} else {
							textBtn.className = "hf-btn hf-btn-on";
							//this.style.color="#333";
						}
						//textNub.innerHTML = len + "/100";
					}
				}
				//遍历结束
			}

			function BJ() {
				var pnBJ = document.getElementById("pnBJ");
				var listBJ = pnBJ.children;
				//删除当前节点
				function remove(node) {
					node.parentNode.removeChild(node);
				}
				//遍历所有状态消息
				for(var i = 0; i < listBJ.length; i++) {
					//全部事件代理
					listBJ[i].onclick = function(e) {
						//获取当前点击事件
						var e = e || window.event;
						var el = e.srcElement;
						if(!el) {
							el = e.target; //兼容火狐
						}
						//判断点击的类名
						switch(el.className) {
							//关闭整个状态
							case "close":
								remove(el.parentNode);
								break;
						}
					}
				}
				//遍历结束
			}
			
			//评论收缩
			$(".list0").on("click", ".closeSub", function(){
				var status = $(this).html();
				if(status == "收起回复▲"){
					$(this).closest(".HF_content").find(".comment-list").hide();
					$(this).html("展开回复▼");
				}else{
					$(this).closest(".HF_content").find(".comment-list").show();
					$(this).html("收起回复▲");
				}
			});

			//发布评论
			function FaBu() {
				var NOWTime = getTime();
				var UserName = "{$username}"; //用户名
				var html = ue.getContent();
				var Centont = html; //发布内容
				if(!Centont || Centont.indexOf("在这里畅所欲言吧") > 0){
					layer.alert("请填写评价内容");
					return false;
				}
				//异步提交评论
				var course_id = $("#course_id").val();
				$.ajax({
					type: "post",
					url: "__CONTROLLER__/addComment",
					data: "course_id={$course_id}&content="+encodeURIComponent(Centont),
					dataType: "json",
					success: function(data){
						if(data.code == 1000){
							layer.alert("添加成功");
							window.location.href = window.location.href;
							/* return false;
							var url = "{$avatar}"; //图片路径
							var html = "<li class=\"list0\"><input type=\"hidden\" value=\""+data.last_id+"\" class=\"comment_id\"><a class=\"close\" href=\"javascript:;\" style=\"opacity: 0.6;\">X</a><div class=\"head\"><img src=\"" + url + "\" onerror=\"this.src='__PUBLIC__/Dist/img/avatar5.png'\"/></div><div class=\"HF_content\"><p class=\"text\"><span class=\"name\">" + UserName + "：</span>" + Centont + "</p><div class=\"pic\"></div><div class=\"good\"><span class=\"date\">" + NOWTime + "</span><a class=\"dzan\" href=\"javascript:;\">赞</a></div><div class=\"people\" total=\"0\" style=\"display:none; \">0人觉得很赞</div><div id=\"shou_suo_2\" class=\"comment-list\"></div><div class=\"hf\"><textarea type=\"text\" class=\"hf-text\" autocomplete=\"off\" >请输入您的评论…</textarea><button class=\"hf-btn\">回复</button></div></div></li>";
							$("#pn").prepend(html);
							b();
							//$("#container").html("");//评价发布后自动清空 */
						}else{
							layer.alert(data.message);
						}
					}
				});
			}

			//添加笔记
			function FaBJ() {
				var NOWTime = getTime();
				var UserName = "{$username}"; //用户名
				var Centont = $("#CentontBJ").val(); //发布内容
				Centont = $.trim(Centont);
				var avatar = "{$avatar}"; //图片路径
				var is_public = $(".is_public").is(':checked');
				
				var publicStatus = 1;
				if(!is_public){
					publicStatus = 2;
				}
				if(!Centont){
					layer.alert("请填写笔记内容");
					return false;
				}
				
				var _pnBJ = $("#pnBJ");
				var _CentontBJ = $("#CentontBJ");
				var _is_public = $(".is_public");
				var _icheckbox_square = $(".icheckbox_square-blue");
				$.ajax({
					type: "post",
					url: "__CONTROLLER__/addNote",
					data: "course_id={$course_id}&project_id={$project_id}&content="+encodeURIComponent(Centont)+"&is_public="+publicStatus,
					dataType: "json",
					success: function(data){
						if(data.code == 1000){
							var html = "<li class=\"list0\"><input type=\"hidden\" value=\""+data.last_id+"\" class=\"note_id\"><a class=\"close\" href=\"javascript:;\" style=\"opacity: 0.6;\">X</a><div class=\"head\"><img src=\"" + avatar + "\" onerror=\"this.src='__PUBLIC__/Dist/img/avatar5.png'\"/></div><div class=\"HF_content\"><p class=\"text\"><span class=\"name\">" + UserName + "：</span>" + Centont + "</p><div class=\"pic\"></div><div class=\"good\"><span class=\"date\">" + NOWTime + "</span></div></div></li>";
							_pnBJ.prepend(html);
							_CentontBJ.val("");//笔记发布后自动清空
							_is_public.attr('checked',false);
							_icheckbox_square.removeClass('checked');
						}else{
							layer.alert(data.message);
						}
					}
				});
			}
			
			//删除笔记
			$("#pnBJ").on("click",".close",function(){
				var note_id = $(this).closest("li").find(".note_id").val();
				if(!note_id){
					layer.alert("未获取到笔记id");
					return false;
				}
				layer.confirm("是否删除该笔记？");
				var note_con = $(this).closest("li");
				$(".layui-layer-btn0").click(function(){
					$.ajax({
						type: "post",
						url: "__CONTROLLER__/delNote",
						data: "note_id="+note_id,
						dataType: "json",
						success: function(data){
							if(data.code == 1000){
								note_con.remove();
							}else{
								layer.alert(data.message);
							}
						}
					});
				});
			});
			
			//获取当前时间回复评论时调用
			function getTime() {
				var t = new Date();
				var y = t.getFullYear();
				var m = t.getMonth() + 1;
				var d = t.getDate();
				var h = t.getHours();
				var mi = t.getMinutes();
				m = m < 10 ? "0" + m : m;
				d = d < 10 ? "0" + d : d;
				h = h < 10 ? "0" + h : h;
				mi = mi < 10 ? "0" + mi : mi;
				return y + "-" + m + "-" + d + " " + h + ":" + mi;
			}
			
			//添加课程
			$(".addCourse").click(function(){
				$.ajax({
					type: "post",
					url: "__CONTROLLER__/addCourse",
					data: "course_id={$course_id}",
					dataType: "json",
					success: function(data){
						if(data.code == 1000){
							window.location.href = window.location.href;
						}else{
							layer.alert(data.message);
						}
					}
				});
			});
			
			$(function(){
				var myPlayer = videojs('my-video',{
					controlBar: {
						volumeMenuButton: false,
						progressControl: false,
						remainingTimeDisplay: false,
					}
				});
				
				var seeTime;
				myPlayer.on('play', function() {
					seeTime = setInterval(function(){
						var whereYouAt = myPlayer.currentTime();//获取播放进度（单位秒）
						var timeLeft = myPlayer.remainingTime();
						var seePrecent = whereYouAt / (whereYouAt + timeLeft);
						seePrecent = Math.floor(seePrecent * 100);
						seePrecent = seePrecent.toFixed(2);
						$(".vjs-play-progress").css("width",seePrecent+"%");
						$(".playing .jindu").html(seePrecent+"%");
						var fileType = $(".playing .fileType").val();
						var fileSrc = $(".playing .fileSrc").val();
						var fileName = $(".playing .fileName").val();
						$(".playing .timelen").val(whereYouAt);
						$.ajax({
							type: "post",
							url: "__CONTROLLER__/chapter",
							data: "course_id={$course_id}&project_id={$project_id}&fileName="+fileName+"&fileSrc="+fileSrc+"&fileType="+fileType+"&status=2&time_percent="+seePrecent+"&timeLen="+whereYouAt,
							dataType: "json",
							success: function(data){}
						});
					}, 1000);
					
					var progressHtml = '<div class="vjs-progress-control vjs-control"><div tabindex="0" class="vjs-progress-holder vjs-slider vjs-slider-horizontal" role="slider" aria-valuenow="" aria-valuemin="0" aria-valuemax="100" aria-label="progress bar" aria-valuetext=""><div class="vjs-play-progress vjs-slider-bar" style="width:0%;"><span class="vjs-control-text"><span>Progress</span>: 0%</span></div></div></div>';
					if($(".vjs-progress-control").length == 0){
						$(".vjs-current-time").after(progressHtml);
					}
				});
				
				//暂停播放
				myPlayer.on('pause', function() {  
					clearInterval(seeTime);
				});
				
				//播放结束
				myPlayer.on('ended', function(){
					clearInterval(seeTime);
					$(".playing .jindu").html("100%");
					var whereYouAt = myPlayer.currentTime();//获取播放进度（单位秒）
					var fileType = $(".playing .fileType").val();
					var fileSrc = $(".playing .fileSrc").val();
					var fileName = $(".playing .fileName").val();
					$.ajax({
						type: "post",
						url: "__CONTROLLER__/chapter",
						data: "course_id={$course_id}&project_id={$project_id}&fileName="+fileName+"&fileSrc="+fileSrc+"&fileType="+fileType+"&time_percent=100&status=3&timeLen="+whereYouAt,
						dataType: "json",
						success: function(data){}
					});
				});
				//开始预览
				$(".startPreview").click(function(){
                     
					 var course_id = {$course_id};
					 var chapter_id = $(this).attr("title");
                     $.post("{:U('Admin/MyCourse/preview')}",{course_id:course_id,chapter_id:chapter_id}, function($message) {  
						 
                          if($message.status == 1){  
						
                        
                               if($message.data.file_type == 0){
                                 var loading = layer.load(1);
                                 location.href = $message.url; 
							   }else if($message.data.file_type == 1){
                                //   $('#fview').attr('href',$message.data.view_file_path);
								//   $('#fview').click();
							
							 	location.href = 'http://'+$message.url; 
							   }
							   
							     
                          }else{  
							  layer.msg($message.info, { time: 1000});
                       
                          }     
                      },'json');


				});				
				//开始学习
				$(".startStudy").click(function(){
					 var fileType = $(this).siblings(".fileType").val();
					 var fileSrc = $(this).siblings(".fileSrc").val();
					 var fileName = $(this).siblings(".fileName").val();
					 var timelen = $(this).siblings(".timelen").val();
					 var _this = $(this);
					 if(fileType == "video" || fileType == "audio"){
						$("#cover_box").hide();
						$("#kejian_box").hide();
						$("#video_box").show();
						$(".chapterList .playing").removeClass("playing");
						_this.closest("tr").addClass("playing");
						myPlayer.src(fileSrc);  //重置video的src
					    myPlayer.load(fileSrc);  //使video重新加载
					   	setTimeout(function(){
							myPlayer.currentTime(timelen);//断点续播（单位秒）
						}, 500);
					 }else{
						$("#cover_box").show();
						$("#video_box").hide();
						$("#kejian_box").hide();
						fileSrc = encodeURIComponent(fileSrc);
						fileName = encodeURIComponent(fileName);
						window.open("__MODULE__/myCourse/download?file="+fileSrc+"&fileName="+fileName);
						
						$.ajax({
							type: "post",
							url: "__CONTROLLER__/chapter",
							data: "course_id={$course_id}&project_id={$project_id}&fileName="+fileName+"&status=3&fileSrc="+fileSrc+"&fileType="+fileType,
							dataType: "json",
							success: function(data){
								if(data.code != 1000){
									layer.alert(data.message);
								}else{
									_this.closest("tr").find(".jindu").html("100%");
								}
							}
						});
					 }
				});

				
				//默认媒体地址处理
				var media_type = "{$base.media_type}";
				if(media_type == "video"){
					$("#cover_box").hide();
					$("#kejian_box").hide();
					$("#video_box").show();
					myPlayer.src("{$base.media_src}");  //重置video的src
				    myPlayer.load("{$base.media_src}");  //使video重新加载
				}
			});
			
			//课件播放
			$(".startStudyKejian").click(function(){
				var fileType = $(this).siblings(".fileType").val();
				var fileSrc = $(this).siblings(".fileSrc").val();
				var fileName = $(this).siblings(".fileName").val();
				var _this = $(this);
				$("#cover_box").hide();
				$("#video_box").hide();
				
				$("#kejian_box iframe").attr("src",fileSrc);
				fileSrc = encodeURIComponent(fileSrc);
				$("#kejian_box").show();
				//定时回传数据
				scormSeeTime = setInterval(function(){
					$.ajax({
						type: "post",
						url: "__CONTROLLER__/chapter",
						data: "course_id={$course_id}&project_id={$project_id}&fileName="+fileName+"&status=3&fileSrc="+fileSrc+"&fileType="+fileType,
						dataType: "json",
						success: function(data){
							if(data.code == 1000){
								_this.closest("tr").find(".jindu").html(data.percent+"%");
							}
						}
					});
				}, 5000);
			});
			
			$(".kejianFullScreen").click(function(){
				var fullStatus = $("#kejian_box").attr("class");
				if(fullStatus.indexOf("kejianSetFull") > -1){
					//已全屏
					$("#kejian_box").removeClass("kejianSetFull");
					$("#kejian_box").css({"width":"700px","height":"400px"});
				}else{
					//未全屏
					var pageX = $(window).width();
					var pageY = $(window).height();
					$("#kejian_box").addClass("kejianSetFull");
					$("#kejian_box").css({"width":pageX+"px","height":pageY+"px"});
				}
				/* 
				$(".kejianFullScreen").hide();
				$("#kejian_box").css({"width":"100%","height":"100%"});
				layer.open({
					title: '课件播放',
					area: ['100%', '100%'],
					type: 1,
					skin: 'layui-layer-lan', //样式类名
					closeBtn: 1, //显示关闭按钮
					anim: 2,
					shadeClose: true, //开启遮罩关闭
					content: $("#kejian_box"),
					end: function () {
						$("#kejian_box").css({"width":"700px","height":"400px"});
						$("#kejian_box").show();
						$(".kejianFullScreen").show();
		            }
				}); */
			});

			function HistoryVersion(){
				layer.alert("该课程无历史版本");
			}
			
			//默认媒体地址处理
			var media_type = "{$base.media_type}";
			if(media_type == "kejian"){
				$("#cover_box").hide();
				$("#video_box").hide();
				$("#kejian_box iframe").attr("src","{$base.media_src}");
				$("#kejian_box").show();
			}
			
		</script>
	</body>
</html>