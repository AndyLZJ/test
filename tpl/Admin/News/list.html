<layout name="layout" />
<!--内容开始-->
<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>调研管理——调研列表</title>
		<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
		<link rel="stylesheet" href="__PUBLIC__/Dist/css/comm.css">
		<link rel="stylesheet" href="__PUBLIC__/Css/bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/font-awesome-4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/ionicons-2.0.1/css/ionicons.min.css">
		<link rel="stylesheet" href="__PUBLIC__/plugins/jvectormap/jquery-jvectormap-1.2.2.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/css/AdminLTE.min.css">
		<link rel="stylesheet" href="__PUBLIC__/Dist/css/skins/_all-skins.min.css">
		<link rel="stylesheet" href="__PUBLIC__/layer/skin/layer.css">
		<link rel="stylesheet" href="__PUBLIC__/plugins/iCheck/all.css">
		
	</head>
<style type="text/css">
 th{
		line-height: 35px!important;
	}

 td{
		line-height: 35px!important;
	}


ins, a {
	text-decoration: none;
}
</style>
<!--内容区域顶栏面包屑开始-->
<section class="content-header">
	<h1 class="info_title">
        资讯管理
        <small>/资讯列表</small>
      </h1>
	
</section>
<section class="content">
	<div class="box box-primary">
		<div class="box-body">
			<div id="example1_wrapper" class="dataTables_wrapper form-inline dt-bootstrap">
				<!--筛选栏开始-->
				<div class="row mb10">
					<div class="col-sm-12">
						<button type="button" class="btn btn-primary float_r ml10" onclick="del_all();">
                            <i class="fa fa-trash-o"></i>
                            批量删除
                          </button>
						<a href="{:U('News/add')}">
							<button type="button" class="btn btn-primary float_r ml10">
                            <i class="fa fa-plus"></i>
                            新增
                            
                          </button>
						</a>

					</div>
				</div>
				<!--内容开始-->
				 <div class="row">
                   <div class="col-sm-12">
						 <table id="example1" class="table table-bordered table-striped dataTable" role="grid" aria-describedby="example1_info">
							<thead>
								<tr role="row" class="odd">
									<th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Browser: activate to sort column ascending">
                                     <input type="Checkbox" class="checkbox-all">
                                    </th>
									<th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Browser: activate to sort column ascending">标题
									</th>
									<th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Browser: activate to sort column ascending">发布时间
									</th>
									<th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Browser: activate to sort column ascending">作者
									</th>
									<th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="CSS grade: activate to sort column ascending">操作</th>
								</tr>
							</thead>
							<tbody id="tab" class="new_table">
								<form method="post" action="{:U('news/multidel')}">
									<foreach name='news' item='vo'>
										<tr role="row" class="odd">
											<td><input class="checkbox" type="Checkbox" name="checkbox[]" value="<if condition='$vo.isequality neq 1'>{$vo.id}<else/>0</if>"></td>
											
											<td><span class="mr5 text-yellow">[{$vo.template}][{$vo.type}]</span>{$vo.title}</td>
											<td> {$vo.create_time}</td>
											<td>{$vo.username}</td>
											<td>
												<a href="{:U('news/show',['id' => $vo['id']])}" class="mr20">
													<i class="fa fa-eye mr5" aria-hidden="true"></i>预览
												</a>
      
                                                <if condition="$vo['isequality'] neq 1">
												<a href="{:U('news/edit',['id' => $vo['id']])}" class="bs-callout-info mr20">
													<i class="fa fa-pencil mr5" aria-hidden="true"></i>编辑
												</a>
												<!--<a href="{:U('news/delone',['id' => $vo['id']])}" class="color_or mr20" >-->
												<a href="#" class="bs-callout-info color_or" onclick="del_click('{$vo.id}');">
													<i class="fa fa-trash-o mr5" aria-hidden="true"></i>删除
												</a>
                                                </if>

											</td>
										</tr>
									</foreach>
								</form>

							</tbody>
						</table>
					</div>
				</div>
				<!--内容結束-->
				<!--分页开始-->
				<div class="row">
					<div class="float_r mr15">
						<div class="dataTables_paginate paging_simple_numbers">
							<ul class="pagination">
								{$page}
							</ul>
						</div>
					</div>
				</div>
				<!--分页结束-->
			</div>
		</div>
	</div>
</section>
<!--编辑角色窗口-->
        <script src="__PUBLIC__/plugins/jQuery/jquery-2.2.3.min.js"></script>
        <script src="__PUBLIC__/Js/js/bootstrap.min.js"></script>
        <script src="__PUBLIC__/plugins/fastclick/fastclick.js"></script>
        <script src="__PUBLIC__/Dist/js/app.min.js"></script>
        <script src="__PUBLIC__/plugins/sparkline/jquery.sparkline.min.js"></script>
        <script src="__PUBLIC__/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
        <script src="__PUBLIC__/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
        <script src="__PUBLIC__/plugins/slimScroll/jquery.slimscroll.min.js"></script>
        <script src="__PUBLIC__/plugins/chartjs/Chart.min.js"></script>
        <script src="__PUBLIC__/Dist/js/pages/dashboard2.js"></script>
        <script src="__PUBLIC__/plugins/iCheck/icheck.min.js"></script>
        <script src="__PUBLIC__/Dist/js/demo.js"></script>
        <script src="__PUBLIC__/plugins/ckeditor/ckeditor.js"></script>
        <script src="__PUBLIC__/Dist/js/demo.js"></script>
        <script src="__PUBLIC__/plugins/layer/layer.js"></script>
<script type="text/javascript">

 $('input').iCheck({ 
    labelHover : false, 
    cursor : true, 
    checkboxClass : 'icheckbox_square-blue', 
    radioClass : 'iradio_minimal-blue', 
    increaseArea : '20%' 
  }); 

    //全选checkbox
  var $checkboxAll = $(".checkbox-all"),
            $checkbox = $(".new_table").find("[type='checkbox']").not("[disabled]"),
            length = $checkbox.length,
            i=0;

    $checkboxAll.on("ifClicked",function(event){
        if(event.target.checked){
            $checkbox.iCheck('uncheck');
			$('.checkbox').attr("checked", 'flase');
            i=0;
        }else{
            $checkbox.iCheck('check');
			$('.checkbox').attr("checked","checked")
            i=length;
        }
    });
	//radio选中样式
	$(document).ready(function() {
		$("#all").click(function() {
			$('input[type="checkbox"]').prop("checked", this.checked);
		});
	});

	//批量删除--input框的form提交
	function del_all_old() {
		layer.confirm('您确定要批量删除这些资讯吗？', {
				title: '批量删除',
				btn: ['确定删除', '取消操作'],
				shadeClose: true, //开启遮罩关闭
				skin: 'layui-layer-lan'
					//按钮
			},
			function() {
				var news = document.getElementsByName('checkbox[]');

				for(var i = 0, ress = 0; i < news.length; i++) {
					if(news[i].checked) {
						ress = ress + 1;
						alert(news[i].value);
					}

				}
				  alert(ress);

				if(ress >= 1) {
					$("form").submit();
					layer.msg('删除成功', {
						time: 1000,
						icon: 1
					});
				} else {
					layer.msg('请勾选信息', {
						time: 1000
					});
				}

			},
			function() {
				layer.msg('取消操作', {
					time: 1000
				});
			});
	}

    //批量删除
	function del_all() {
				layer.confirm('您确定要批量删除这些资讯吗？', {
					btn: ['确定', '取消'],
					skin: 'layui-layer-lan'
						//按钮
				}, 
				function() {
				
				var lists=document.getElementsByName('checkbox[]');
				var auditType = $('#auditType').val();
                

                var ids  = new Array();
                  for (var i = 0,ress=0; i < lists.length; i++) {
                      if(lists[i].checked){
                       ress=ress+1;
                       ids.push(lists[i].value);
                      }

                  }      
                if(ress>=1){
					$.post("{:U('Admin/news/multidel')}",{ids:ids}, function(data) {  
                        
                          if(data.status == 1){  
							  layer.msg(data.info,{time: 1000,icon: 1});//bootstrap框架确认弹窗
                               
                             setTimeout(function(){
                               location.href = data.url; 
                              },1000);   
							
                          }else{  
							  layer.msg(data.info, { time: 1000});
                               location.href = data.url; 
                          }     
                      },'json');
                }else{
                  layer.msg('请勾选一条数据', {time: 1000}); 
                }
				});
			}





	//单个删除
	function del_click(sid) {
		layer.confirm('您确定要删除此消息吗？', {
				title: '删除',
				btn: ['确定删除', '取消操作'],
				shadeClose: true, //开启遮罩关闭
				skin: 'layui-layer-lan'
					//按钮
			}, function() {

				// var sid = id;
				// alert(sid);exit; 
				location.href = '{:U("Admin/news/delone")}?id=' + sid;
				layer.msg('删除成功', {
					time: 1000
				});
			},
			function() {
				layer.msg('取消操作', {
					time: 1000
				});
			});
	}
</script>
</body>

</html>